# ==============================================
# CONFIGURATION SHIFA+ GOUVERNEMENTAL - ENVIRONNEMENT
# ==============================================
# Copier ce fichier en .env et modifier les valeurs
# Application Gouvernementale - Spring Boot + Angular

# ==============================================
# BASE DE DONNÉES POSTGRESQL
# ==============================================
# Configuration Spring Boot (application.yml)
SPRING_DATASOURCE_URL=jdbc:postgresql://localhost:5432/shifa_db
SPRING_DATASOURCE_USERNAME=shifa_user
SPRING_DATASOURCE_PASSWORD=shifa_secure_pass_2024
SPRING_DATASOURCE_DRIVER_CLASS_NAME=org.postgresql.Driver

# Configuration Docker
POSTGRES_DB=shifa_db
POSTGRES_USER=shifa_user
POSTGRES_PASSWORD=shifa_secure_pass_2024
POSTGRES_PORT=5432
DATABASE_URL=postgresql://shifa_user:shifa_secure_pass_2024@localhost:5432/shifa_db

# ==============================================
# REDIS (Cache & Sessions)
# ==============================================
SPRING_REDIS_HOST=localhost
SPRING_REDIS_PORT=6379
SPRING_REDIS_PASSWORD=redis_secure_pass
REDIS_URL=redis://localhost:6379
REDIS_PASSWORD=redis_secure_pass
REDIS_PORT=6379

# ==============================================
# APACHE KAFKA (Event Streaming)
# ==============================================
KAFKA_BOOTSTRAP_SERVERS=localhost:9092
KAFKA_ZOOKEEPER_CONNECT=localhost:2181
KAFKA_TOPIC_NOTIFICATIONS=notifications
KAFKA_TOPIC_REMBOURSEMENTS=remboursements
KAFKA_TOPIC_DOCUMENTS=documents
KAFKA_CONSUMER_GROUP_ID=shifa-consumer-group

# Spring Kafka Configuration
SPRING_KAFKA_BOOTSTRAP_SERVERS=localhost:9092
SPRING_KAFKA_CONSUMER_GROUP_ID=shifa-consumer-group
SPRING_KAFKA_CONSUMER_AUTO_OFFSET_RESET=earliest

# ==============================================
# MINIO / S3 (Stockage de Documents)
# ==============================================
S3_ENDPOINT=http://localhost:9000
S3_ACCESS_KEY=minioadmin
S3_SECRET_KEY=minioadmin123
S3_BUCKET=shifa-documents
S3_REGION=us-east-1

MINIO_ROOT_USER=minioadmin
MINIO_ROOT_PASSWORD=minioadmin123
MINIO_PORT=9000
MINIO_CONSOLE_PORT=9001

# Spring Cloud AWS S3
SPRING_CLOUD_AWS_S3_ENDPOINT=http://localhost:9000
SPRING_CLOUD_AWS_S3_ACCESS_KEY=minioadmin
SPRING_CLOUD_AWS_S3_SECRET_KEY=minioadmin123
SPRING_CLOUD_AWS_S3_BUCKET=shifa-documents

# ==============================================
# BACKEND API (Spring Boot)
# ==============================================
SERVER_PORT=8080
SPRING_PROFILES_ACTIVE=development
FRONTEND_URL=http://localhost:4200
API_BASE_URL=http://localhost:8080

# ==============================================
# KEYCLOAK (Authentification & IAM)
# ==============================================
KEYCLOAK_SERVER_URL=http://localhost:8180
KEYCLOAK_REALM=shifa
KEYCLOAK_CLIENT_ID=shifa-backend
KEYCLOAK_CLIENT_SECRET=votre_keycloak_client_secret_changez_moi
KEYCLOAK_ADMIN_USER=admin
KEYCLOAK_ADMIN_PASSWORD=admin

# Spring Security OAuth2
SPRING_SECURITY_OAUTH2_RESOURCESERVER_JWT_ISSUER_URI=http://localhost:8180/realms/shifa
SPRING_SECURITY_OAUTH2_RESOURCESERVER_JWT_JWK_SET_URI=http://localhost:8180/realms/shifa/protocol/openid-connect/certs

# ==============================================
# PKI (CIN Électronique)
# ==============================================
PKI_ENABLED=true
PKI_CERTIFICATE_AUTHORITY_URL=https://pki.anrt.ma
PKI_VALIDATION_ENABLED=true
PKI_TRUSTSTORE_PATH=/etc/ssl/certs/pki-truststore.jks
PKI_TRUSTSTORE_PASSWORD=votre_truststore_password_changez_moi

# ==============================================
# HSM (Hardware Security Module)
# ==============================================
HSM_ENABLED=true
HSM_PROVIDER=PKCS11
HSM_LIBRARY_PATH=/usr/lib/hsm/libpkcs11.so
HSM_SLOT_ID=0
HSM_PIN=votre_hsm_pin_changez_moi
HSM_KEY_ALIAS=shifa-encryption-key

# ==============================================
# JWT (JSON Web Tokens - Keycloak)
# ==============================================
# Les JWT sont gérés par Keycloak, mais pour les tokens internes :
JWT_SECRET=votre_jwt_secret_tres_securise_minimum_32_caracteres_changez_moi
JWT_EXPIRES_IN=3600
JWT_REFRESH_EXPIRES_IN=86400

# ==============================================
# FRONTEND (Angular)
# ==============================================
NG_API_URL=http://localhost:8080
NG_WS_URL=ws://localhost:8080/ws
NG_KEYCLOAK_URL=http://localhost:8180
NG_KEYCLOAK_REALM=shifa
NG_KEYCLOAK_CLIENT_ID=shifa-frontend

# Variables d'environnement Angular (environments/environment.ts)
API_BASE_URL=http://localhost:8080
WS_BASE_URL=ws://localhost:8080/ws
KEYCLOAK_URL=http://localhost:8180
KEYCLOAK_REALM=shifa
KEYCLOAK_CLIENT_ID=shifa-frontend

# ==============================================
# CHIFFREMENT (Documents Médicaux)
# ==============================================
# AES-256 avec clés gérées par HSM
ENCRYPTION_ALGORITHM=AES/GCM/NoPadding
ENCRYPTION_KEY_SIZE=256
ENCRYPTION_IV_SIZE=12
ENCRYPTION_TAG_SIZE=128

# Clé de chiffrement (fallback si HSM non disponible en dev)
ENCRYPTION_KEY=01234567890123456789012345678901
ENCRYPTION_KEY_DEV_ONLY=true

# ==============================================
# EMAIL (SMTP)
# ==============================================
SPRING_MAIL_HOST=smtp.gmail.com
SPRING_MAIL_PORT=587
SPRING_MAIL_USERNAME=votre-email@gmail.com
SPRING_MAIL_PASSWORD=votre-mot-de-passe-app
SPRING_MAIL_PROPERTIES_MAIL_SMTP_AUTH=true
SPRING_MAIL_PROPERTIES_MAIL_SMTP_STARTTLS_ENABLE=true
SPRING_MAIL_FROM=noreply@shifa.gov.ma
SPRING_MAIL_FROM_NAME=Shifa+ Gouvernemental

# ==============================================
# MONITORING & OBSERVABILITÉ
# ==============================================
# Actuator
MANAGEMENT_ENDPOINTS_WEB_EXPOSURE_INCLUDE=health,info,metrics,prometheus
MANAGEMENT_ENDPOINT_HEALTH_SHOW_DETAILS=always
MANAGEMENT_METRICS_EXPORT_PROMETHEUS_ENABLED=true

# Logging
LOGGING_LEVEL_ROOT=INFO
LOGGING_LEVEL_MA_GOV_SANTE_SHIFA=DEBUG
LOGGING_FILE_NAME=logs/shifa-application.log
LOGGING_FILE_MAX_SIZE=10MB
LOGGING_FILE_MAX_HISTORY=30

# ELK Stack (optionnel)
ELASTICSEARCH_HOST=localhost
ELASTICSEARCH_PORT=9200
LOGSTASH_HOST=localhost
LOGSTASH_PORT=5044

# Prometheus
PROMETHEUS_ENABLED=true
PROMETHEUS_PORT=9090

# ==============================================
# SÉCURITÉ
# ==============================================
# Rate Limiting (Bucket4j)
RATE_LIMIT_ENABLED=true
RATE_LIMIT_CAPACITY=100
RATE_LIMIT_REFILL_DURATION=60
RATE_LIMIT_REFILL_TOKENS=100

# CORS
CORS_ALLOWED_ORIGINS=http://localhost:4200,http://localhost:3000
CORS_ALLOWED_METHODS=GET,POST,PUT,PATCH,DELETE,OPTIONS
CORS_ALLOWED_HEADERS=*
CORS_ALLOW_CREDENTIALS=true

# Security Headers
SECURITY_HEADERS_ENABLED=true
SECURITY_HEADERS_CSP_ENABLED=true

# MFA (Multi-Factor Authentication)
MFA_ENABLED=true
MFA_TOTP_ISSUER=Shifa+ Gouvernemental

# ==============================================
# AUDIT & CONFORMITÉ
# ==============================================
AUDIT_ENABLED=true
AUDIT_LOG_ALL_ACCESS=true
AUDIT_RETENTION_DAYS=2555
AUDIT_ENCRYPTED=true

# RGPD / CNDP
RGPD_ENABLED=true
DATA_RETENTION_DAYS=2555
DATA_EXPORT_ENABLED=true

# ==============================================
# INTÉGRATIONS EXTERNES
# ==============================================
# CNOPS
CNOPS_API_URL=https://api.cnops.ma
CNOPS_API_KEY=votre_cnops_api_key_changez_moi
CNOPS_API_TIMEOUT=30000

# CNSS
CNSS_API_URL=https://api.cnss.ma
CNSS_API_KEY=votre_cnss_api_key_changez_moi
CNSS_API_TIMEOUT=30000

# ==============================================
# ENVIRONNEMENT
# ==============================================
ENVIRONMENT=development
APP_NAME=Shifa+ Gouvernemental
APP_VERSION=1.0.0
APP_DESCRIPTION=Application nationale de gestion de santé

# Note: Copier ce fichier en .env et changer tous les secrets en production
# En production, utiliser des variables d'environnement sécurisées ou un gestionnaire de secrets (Vault, AWS Secrets Manager, etc.)

